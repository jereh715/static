<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Raw lastSearchResults Cache</title>
</head>
<body>

<h1>Raw Cache: lastSearchResults</h1>

<button onclick="loadCache()">Load Cache</button>
<button onclick="clearView()">Clear View</button>

<p id="info"></p>

<pre id="raw"></pre>

<hr>

<div id="list"></div>

<script>
function loadCache() {
  const info = document.getElementById("info");
  const raw = document.getElementById("raw");
  const list = document.getElementById("list");

  raw.textContent = "";
  list.innerHTML = "";

  const cached = localStorage.getItem("lastSearchResults");

  if (!cached) {
    info.textContent = "No lastSearchResults found in localStorage.";
    return;
  }

  let data;
  try {
    data = JSON.parse(cached);
  } catch (e) {
    info.textContent = "Cache exists but is not valid JSON.";
    raw.textContent = cached;
    return;
  }

  info.textContent = "Products in cache: " + data.length;

  // Show raw JSON
  raw.textContent = JSON.stringify(data, null, 2);

  // Show each item plainly
  data.forEach((item, index) => {
    const div = document.createElement("div");
    div.innerHTML = `
      <strong>#${index + 1}</strong><br>
      Title: ${item.title || "N/A"}<br>
      Price: ${item.price || "N/A"}<br>
      Source: ${item.source || "N/A"}<br>
      Link: ${item.link || item.product_link || "N/A"}<br>
      <hr>
    `;
    list.appendChild(div);
  });
}

function clearView() {
  document.getElementById("info").textContent = "";
  document.getElementById("raw").textContent = "";
  document.getElementById("list").innerHTML = "";
}
</script>

</body>
</html>
